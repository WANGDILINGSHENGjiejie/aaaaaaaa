<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>首页 - 核桃书吧</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache,must-revalidate">
    <meta http-equiv="expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <script src="https://static01.tengwen.com/adminlte/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="https://static01.tengwen.com/adminlte/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/common/jquery.qrcode.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/common/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/common/clipboard.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/backend/novel/js/klorofil-common.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/backend/novel/js/comm.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/common/moment.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/backend/novel/js/moment_zh-cn.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/common/bootstrap-datetimepicker-4.17.min.js"></script>
    <script type="text/javascript" src="https://static01.tengwen.com/backend/novel/js/echarts.min.js"></script>
    <script src="https://static01.tengwen.com/common/toastr.min.js"></script>
    <link rel="stylesheet" href="https://static01.tengwen.com/adminlte/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://static01.tengwen.com/adminlte/bower_components/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/novel.css">
    <link rel="stylesheet" href="https://static01.tengwen.com/backend/novel/css/media.css">
    <link rel="stylesheet" href="https://static01.tengwen.com/common/bootstrap-datetimepicker-4.17.min.css">
    <link rel="stylesheet" href="https://static01.tengwen.com/common/toastr.min.css">
</head>

<body>
    <div id="wrapper">
        <nav class="navbar navbar-default navbar-fixed-top" style="height: 50px;background-color: #2a3747;">
            <div class="brand" style="padding:0;background-color: #2a3747;"><a href="javascript:void(0);"></div>
            <div class="container-fluid">
                <div class="navbar-btn">
                    <button type="button" class="btn-toggle-fullwidth"><i class="fa fa-list" aria-hidden="true" style="color:#fff;"></i>
                    </button>
                </div>
                <div id="navbar-menu">
                        <ul class="nav navbar-nav navbar-right">
                            <li class="dropdown">
                                <a href="/notice/index" class="dropdown-toggle icon-menu"> 
                                    <span class="badge bg-danger notice_msgnum"></span>
                                </a>
                            </li>
                            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><img src="./images/headshot@2x.png"
                                        class="img-circle">
                                    <span style="color:#f1f1f1;">核桃书吧</span> <i class="fa fa-angle-down" aria-hidden="true" style="color:#f1f1f1;"></i></a>
                                <ul class="dropdown-menu">
                                    <li><a href="./personaldata.gr.html"><i class="fa fa-user-circle-o" aria-hidden="true"></i><span>个人资料</span></a>
                                    </li>
                                    <li><a href="Publicnumbersetting-gz.html"><i class="fa fa-address-card-o" aria-hidden="true"></i><span>公众号设置/接入</span></a>
                                    </li>
                                    <li><a href="https://static01.tengwen.com/backend/novel/docx/tengwen_readme.docx"><i
                                                class="fa fa-arrow-down" aria-hidden="true"></i><span>下载帮助文档</span></a>
                                    </li>
                                    <li><a href="./Platformlogin.html" onclick="return confirm('确认退出？')"><i class="fa fa-fw fa-power-off"
                                                aria-hidden="true"></i> <span>安全退出</span></a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
            </div>
        </nav> <!-- END NAVBAR -->
        <!-- LEFT SIDEBAR -->
        <div id="sidebar-nav" class="sidebar">
            <div class="sidebar-scroll" style="overflow-y: auto;height: 100%;padding:20px 0;background-color:#354051;">
                <nav>
                    <ul class="nav">
                        <li><a href="./AnnounceList_gg.html" id="noticemenu"><i class="fa fa-bell-o" aria-hidden="true"></i><span
                                    class="menu-span">公告列表</span></a></li>
                        <li><a href="./Profiledata_sj.html"><i class="fa fa-line-chart" aria-hidden="true"></i><span
                                    class="menu-span">数据概况</span></a></li>
                        <li><a href="./ordersummary.html"><i class="fa fa-bar-chart" aria-hidden="true"></i><span class="menu-span">订单汇总</span></a></li>
                        <li><a href="./Usersummary.html"><i class="fa fa-pie-chart" aria-hidden="true"></i><span class="menu-span">用户汇总</span></a></li>
                        <li><a href="./addsup_xs.html"><i class="fa fa-bars" aria-hidden="true"></i><span class="menu-span">小说充值汇总</span></a></li>
                        <li><a href="./orderdetails_dd.html"><i class="fa fa-list-alt" aria-hidden="true"></i><span
                                    class="menu-span">订单明细</span></a></li>
                        <li><a href="./subsidiary_fs.html"><i class="fa fa-id-card-o" aria-hidden="true"></i><span
                                    class="menu-span">粉丝明细</span></a></li>
                        <li><a href="./library-xs.html"><i class="fa fa-book" aria-hidden="true"></i><span
                                    class="menu-span">小说库</span></a></li>
                        <li><a href="./Promotion-tg.html"><i class="fa fa-chain-broken" aria-hidden="true"></i><span
                                    class="menu-span">推广列表</span></a></li>
                        <li><a href="./listinterpolatel-nt.html"><i class="fa fa-link" aria-hidden="true"></i><span
                                    class="menu-span">内推列表</span></a></li>
                        <li><a href="./Listofactivities-hd.html"><i class="fa fa-shopping-cart" aria-hidden="true"></i><span
                                    class="menu-span">活动列表</span></a></li>
                        <li><a href="./antistop-gj.html"><i class="fa fa-comments-o" aria-hidden="true"></i><span class="menu-span">关键词回复</span></a></li>
                        <li><a href="./Linkstorecycle-lj.html"><i class="fa fa-recycle" aria-hidden="true"></i><span
                                    class="menu-span">链接回收</span></a></li>
                        <li><a href="./Intelligentpush-zn.html"><i class="fa fa-reply-all" aria-hidden="true"></i><span
                                    class="menu-span">智能推送</span></a></li>
                        <li><a href="./Templatemessage-mb.html"><i class="fa fa-envelope-open" aria-hidden="true"></i><span
                                    class="menu-span">模版消息</span></a></li>
                        <li><a href="newsoftheservice-kf.html"><i class="fa fa-commenting-o" aria-hidden="true"></i><span
                                    class="menu-span">客服消息</span></a></li>
                                    <li><a href="./promoteincome-sr.html"><i class="fa fa-jpy" aria-hidden="true"></i><span class="menu-span">推广收入</span></a></li>
                                    <li><a href="./withdrawalofsubsidiary-tx.html"><i class="fa fa-list-alt" aria-hidden="true"></i><span
                                                class="menu-span">提现明细</span></a></li>
                                    <li><a href="./Publicnumbersetting-gz.html" class="active"><i class="fa fa-cog" aria-hidden="true"></i><span
                                                class="menu-span">公众号设置</span></a></li>
                                    <li><a href="./OtherSettings-qt.html"><i class="fa fa-cogs" aria-hidden="true"></i><span
                                                class="menu-span">其它设置</span></a></li>
                    </ul>
                </nav>
            </div>

        </div>
        <div class="main">
            <div class="main-content">
                <div class="container-fluid">

                    <style type="text/css">

                    </style>



                    <div class="panel">
                        <div class="panel-heading mynav">
                            <h3 class="panel-title">
                                <i class="fa fa-home" aria-hidden="true"></i>首页 &gt; <h7 class="menu-name">公众号设置</h7>
                            </h3>
                        </div>


                        <!--TITLE-->
                        <div class="panel-body" >
                            <ul class="nav nav-tabs" role="tablist">
                                <li role="presentation" class="active">
                                    <a href="#home" aria-controls="home" role="tab" data-toggle="tab">公众号设置</a>
                                </li>
                                <li role="presentation">
                                    <a href="#profile" aria-controls="profile" role="tab" data-toggle="tab" >公众号接入信息</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane active" id="home" style="padding:10px 0">
                                    <form class="form-horizontal" id="editform" style="font-size:14px;">
                                        <strong class="col-sm-10" style="padding-top: 10px;">公众信息设置</strong>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">原始ID</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="mp_original_id" name="mp_original_id"
                                                    placeholder="" value="gh_58aaa410fbc9">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">微信号</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="mp_wxno" name="mp_wxno"
                                                    placeholder="" value="hetaoshuba">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">公众号昵称</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="mp_name" name="mp_name"
                                                    placeholder="" value="核桃书吧">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">AppId</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="mp_appid" name="mp_appid"
                                                    placeholder="" value="wx116bc710cab0cd6e">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">AppSecret</label>
                                            <div class="col-sm-8">
                                                <input type="text" class="form-control" id="mp_appsecret" name="mp_appsecret"
                                                    placeholder="" value="7c83fa867a039a7c2ba801c0977de039">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPassword3" class="col-sm-3 control-label">IP白名单</label>
                                            <div class="col-sm-8">
                                                <span id="ip-white-list">
                                                    120.78.66.98<br>
                                                    120.79.17.113<br>
                                                    47.106.134.35<br>
                                                    39.108.94.230
                                                </span>
                                                <div style="margin-top:10px;">
                                                    <a href="javascript:;" data-toggle="copy" data-clipboard-target="#ip-white-list" style="color:#a27bb4;">
                                                        <i class="fa fa-copy"></i>点击复制IP
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputEmail3" class="col-sm-3 control-label">关注二维码</label>
                                            <div class="col-sm-8">

                                                <div class="input-group" style="padding-bottom: 1%; border:none;" >
                                                    <img src="https://static.tengwen.com/updata/seru/20041/1809/20180907111837k7ux.jpg"
                                                        alt="" style="max-width:300px;" id="qrCodespic">
                                                </div>
                                                <div class="input-group" style="margin-top:2%;">
                                                    <input type="text" class="form-control" name="qrcodepic" id="qrcodepic"
                                                        placeholder="" value="updata/seru/20041/1809/20180907111837k7ux.jpg"
                                                        readonly="">
                                                    <span class="input-group-btn">
                                                        <button type="button" id="img-submit" class="btn " style="z-index: 2;background-color:#7a8dab;color:#fff;">上传图片</button>
                                                        <div id="html5_1cmf12cbss2lds51hcs1mfc181d4_container" class="moxie-shim moxie-shim-html5"
                                                            style="position: absolute; top: 0px; left: -1px; width: 102px; height: 34px; overflow: hidden; z-index: 1;">
                                                            <input id="html5_1cmf12cbss2lds51hcs1mfc181d4" type="file"
                                                                style="font-size: 999px; opacity: 0; position: absolute; top: 0px; left: 0px; width: 100%; height: 100%;"
                                                                multiple="" accept=".jpg,.png" tabindex="-1">
                                                        </div>
                                                        <div id="html5_1cso5em8t1pqjusd3pti1i18e24_container" class="moxie-shim moxie-shim-html5"
                                                            style="position: absolute; top: 0px; left: -1px; width: 102px; height: 34px; overflow: hidden; z-index: 1;"><input
                                                                id="html5_1cso5em8t1pqjusd3pti1i18e24" type="file"
                                                                style="font-size: 999px; opacity: 0; position: absolute; top: 0px; left: 0px; width: 100%; height: 100%;"
                                                                multiple="" accept=".jpg,.png" tabindex="-1"></div>
                                                    </span>
                                                </div>
                                                <span class="inputtip">上传的图片地址，保存生效</span>
                                            </div>
                                        </div>
                                        <strong class="col-sm-10" style="padding-top: 10px;">客服信息设置</strong>
                                        <div class="form-group">
                                                <label for="inputPassword3" class="col-sm-3 control-label">微信客服</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" id="mp_original_id" name="mp_original_id"
                                                        placeholder="" value="">
                                                </div>
                                            </div>
                                            <span class="inputtip" style="padding-left:26%;">可填微信号或上传微信二维码图片,如为空,则由平台客服受理粉丝问题</span>
                                            <div class="form-group" style="margin-top:10px;">
                                                <label for="inputPassword3" class="col-sm-3 control-label">微信客服</label>
                                                <div class="col-sm-8">
                                                    <input type="text" class="form-control" id="mp_wxno" name="mp_wxno"
                                                        placeholder="" value="">
                                                </div>
                                            </div>
                                            <span class="inputtip" style="padding-left:26%;">将显示在首页底部,不填而不显示</span>
                                        <div class="form-group" >
                                            <label for="inputPassword3" class="col-sm-3 control-label"></label>
                                            <div class="col-sm-8" style="margin-top:20px;">
                                                <button type="button" id="wx-submit" class="btn " style="width:100px;background-color:#52627d;color:#fff;">保存
                                                </button>
                                                <span class="green tipmsg">&nbsp;</span>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div role="tabpanel" class="tab-pane form-horizontal" id="profile" style="padding:10px 0">
                                    <div class="alert alert-warning alert-dismissible" role="alert">注意: 接入公众号必须是"认证服务号"</div>
                                    <strong class="col-sm-10" style="padding-top: 10px;">公众号设置 (微信后台 &gt; 公众号设置 &gt;
                                        功能设置)</strong>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">网站首页</label>
                                        <div class="col-sm-8">https://wx116bc710cab0cd6e.tengwen.com/</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">业务域名</label>
                                        <div class="col-sm-8">wx116bc710cab0cd6e.tengwen.com</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">JS接口安全域名</label>
                                        <div class="col-sm-8">wx116bc710cab0cd6e.tengwen.com</div>
                                    </div>
                                    <strong class="col-sm-10" style="padding-top: 10px;">公众号回复 (微信后台 &gt; 基本配置)</strong>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">网页授权域名</label>
                                        <div class="col-sm-8">wx116bc710cab0cd6e.tengwen.com</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">URL(服务器地址)</label>
                                        <div class="col-sm-8">https://wx116bc710cab0cd6e.tengwen.com/weixin/api.php</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">Token(令牌)</label>
                                        <div class="col-sm-8">nzu8gztsn828klzhimgv37engi2s8b9e</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">EncodingAESKey(消息加解密密钥)</label>
                                        <div class="col-sm-8">随机</div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3  control-label" style="padding-top:0;">消息加解密方式</label>
                                        <div class="col-sm-8">明文模式</div>
                                    </div>
                                    <div class="form-group">
                                        <label for="inputPassword3" class="col-sm-3 control-label"></label>
                                        <div class="col-sm-8">
                                            <button type="button" id="wx-make-menusubmit" class="btn" style="width:150px;background-color:#3b86e0;color:#fff;">
                                                生成公众号菜单
                                            </button>
                                            <span class="green tipmsg1">&nbsp;</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--TITLE END-->
                    </div>


                </div>
            </div>
        </div>
    </div>
    <div class="clearfix">
    </div>
    <footer></footer>


    <style>
        .toast-top-center {
            top: 52px;
        }
    </style>

    <script>
        api.CopyText_modal();
        var imgurl = 'static01.tengwen.com';

        var menuName = $("h7.menu-name").text();

        $("span.menu-span").each(function () {

            var menuTitle = $(this).text();

            if (menuTitle == menuName) {

                $(this).parent().addClass('active');

                if (menuName == "公告列表") {

                    $(this).css('color', 'rgb(232, 86, 86)');

                }
            }

        });


        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": false,
            "progressBar": false,
            "positionClass": "toast-top-center", //toast-top-center toast-bottom-center
            "preventDuplicates": false,
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "3000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut",
        }

        function adm_ajax_ckstat(stat) {
            if (stat == "ok") return true;

            if (stat == "nologin") {
                window.location.reload();
            }
            return false;
        }

        var pdata = {
            action: 'notice_msg'
        };

        sendData("/notice/notice_msg", pdata, function (data) {
            var data = data.data;
            _Notice = data.data.unrdnum;
            _unReadTop = data.data.unrdmsg;
            noticemsg.showmsgnumEx(_Notice);
            noticemsg.autoreaddlg();

        });
    </script>
    <script src="https://static01.tengwen.com/common/plupload.full.min.js"></script>
    <script>
        var uploader1 = new plupload.Uploader({
            runtimes: 'html5,flash,silverlight,html4',
            browse_button: 'img-submit', // you can pass in id...
            url: "/setting/pic_load?is_ajax=1", ///thumb
            filters: {
                max_file_size: '2mb',
                mime_types: [{
                    title: "Image files",
                    extensions: "jpg,png"
                }]
            },
            // Flash settings
            flash_swf_url: '//static01.tengwen.com/novel/js/Moxie.swf',
            // Silverlight settings
            silverlight_xap_url: '//static01.tengwen.com/novel/js/Moxie.xap',
            init: {
                PostInit: function () {

                },
                Error: function (up, err) {
                    api.submitStatus(false, "#img-submit", '上传图片');
                    $("#qrcodepic,#img-submit").removeAttr('disabled');
                    alert("Error #" + err.code + ": " + err.message);
                },
                FileUploaded: function (up, file, res) {
                    var rtn = jQuery.parseJSON(res.response);

                    rtn = rtn.data;

                    $("#qrcodepic,#img-submit").removeAttr('disabled');

                    $("#qrcodepic").val(rtn.path);

                    $('img#qrCodespic').attr('src', "https://static.tengwen.com/" + rtn.path);

                    api.submitStatus(false, "#img-submit", '上传图片');
                },
                QueueChanged: function (up) {
                    api.submitStatus(true, "#img-submit", '上传中...');
                    uploader1.start();
                    $("#qrcodepic,#img-submit").attr('disabled', 'true');
                }
            }
        });
        uploader1.init();

        $(function () {
            $('[data-toggle="copy').each(function () {
                new Clipboard(this).on('success', function (e) {
                    e.clearSelection();
                    toastr.success('复制成功');
                });
            });

            $("#wx-submit").bind("click", function () {
                handledata();
            });
            $(".form-control").bind("focus", function () {
                $(".tipmsg").html("&nbsp;");
            });

            $(":input").each(function (index, el) {
                $(el).keypress(function (e) {
                    if (e.keyCode == 13) {
                        handledata();
                    }
                });
            });

            $("#wx-make-menusubmit").bind('click', function (event) {
                event.preventDefault();
                handleMakeMenu();
            });
        });

        function click_follow(isfollow) {
            //$("#followlinkbox").css('display',isfollow==1?'none':'');
        }

        function handleMakeMenu() {
            $(".tipmsg1").html("正在提交...");
            api.submitStatus(true, '#wx-make-menusubmit', '');
            var data = $("#editform").serialize(); //{password:password,password1:password1,password2:password2,};

            sendData('/setting/create_menu', data, function (data) {

                api.submitStatus(false, '#wx-make-menusubmit', '生成公众号菜单');
                if (data.msg.errcode > 0) {
                    $(".tipmsg1").html("生成失败,请重试,多次失败请尝试联系管理员(错误代码" + data.msg.errcode + ")");
                    return;
                }
                if (data.msg.errcode < 0) {
                    $(".tipmsg1").html("系统繁忙,请稍后重试!");
                } else if (data.msg.errcode == 0) {
                    $(".tipmsg1").html('菜单生成成功，大约5分钟后生效');
                }
            });

        }

        function handledata() {
            var err = "";

            if ($("#mp_original_id").val().length == 0) {
                $(".tipmsg").html("请输入原始ID");
                return false;
            }
            if ($("#mp_wxno").val().length == 0) {
                $(".tipmsg").html("请输入微信号");
                return false;
            }
            if ($("#mp_appid").val().length == 0) {
                $(".tipmsg").html("请输入appid");
                return false;
            }
            if ($("#mp_appsecret").val().length == 0) {
                $(".tipmsg").html("请输入appsecret");
                return false;
            }
            if ($("#mp_name").val().length == 0) {
                $(".tipmsg").html("请输入公众号名称");
                return false;
            }

            $(".tipmsg").html("正在提交...");
            api.submitStatus(true, '#wx-submit', '');
            var data = $("#editform").serialize();

            sendData('/setting/save', data, function (data) {
                api.submitStatus(false, '#wx-submit', '保存');
                if (data.msg == '404') {
                    $(".tipmsg").html("网络繁忙,请稍候重试!");
                    return;
                }
                if (data.msg == '200') {
                    $(".tipmsg").html('保存成功');

                    setTimeout("location.reload()", 1000);
                }
            });

            return false;

        }
    </script>

</body>

</html>